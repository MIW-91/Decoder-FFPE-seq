# Overview  
Decoder-FFPE-seq is a dendrimeric DNA coordinate barcoding design for FFPE tissue-adapted spatial RNA sequencing by integrating RNA-to-DNA probe conversion with blotting-assisted barcoding, which establishes a robust, high-resolution, and accessible framework for sensitive ST profiling in fundamental and translational studies of archival tissues.    
Here deposites scripts for validating the effectiveness of Decoder-FFPE-seq and for downstream analyzing the generated data.

# What are these scripts in Validation  
**gene_type_statistic.R** is a script to quantify the gene types that Decoder-FFPE-seq and other technologies can detect. The inputs are the spatial transcriptomic (ST) data preprocessed by DynamicST or Space Ranger, and the gtf file, we used GRCm38 (release 102) for data of mouse tissues.

**diffusion_base_functions.R** is a series of basic functions for calculating the diffusion distance of Decoder-FFPE-seq and other platforms.  

**Pcelltype_spot.R** calculates the numbers of cell types per 8um-spot of a mouse brain section based on the deconvolution result. The input is the cell aboundance matrix estimated by cell2location, which contains the abundance of each cell type in each single spot.  

**rare_GPCR_genes.R** is used for calculating the correlation of non-sensory GPCR gene expression in Decoder-FFPE-seq and MERFISH. It also compares the UMI counts of GPCR per spot and unit area of Decoder-FFPE-seq and other platforms. The mouse non-sensory GPCR genes were obtained from the ‘Mouse GPCRs + Human and Rat Orthologs’ database (https://esbl.nhlbi.nih.gov/Databases/GPCRs/). The inputs are preprocessed gene profiles generated by various technologies, and the GPCR list. 


# What are these scripts in Analysis  
**pseudobulk_expr.R** generates the pseudo bulk expression data of a ST data, and it visualizes the expression of housekeeping gene at a pseudo bulk level, which could be compared with the expression of TCGA samples. The input is a processed gene profile (rds file). Users could define the number of spots involved in a pseudo bulk sample.  

**WGCNA_region.r** performs a weighted gene correlation network analysis for ST data detected both mRNA and lncRNA. The input is a rds file of ST data after clustering and region annotation.  

**Spagene_coloc.R** visualizes the colocalizaion of lncRNA and mRNA of interests. The inputs are the rds file of ST data and an user-defined dataframe, where lncRNA names and mRNA names are in 2 columns.  

**cluster_niches.R** outputs the spatial niches result for a group of ST datasets. The inputs are the ST data preprocessed by DynamicST and the corresponding cell proportion matirx estimated by deconvolution (csv files). Users could define the resolution for clustering.  

**Cell-cell_communication** is a serious of scripts performing cell talk prediction for a 8um-ST data. **1st_run_ccc_commot.py** is for spatial communication inference, the input is the ST data preprocessed by DynamicST. **2nd_run_commot_cluster.py** computes the significant communication between cell types, the input is the h5ad file output by **1st_run_ccc_commot.py**. **3rd_run_ccc_enrich.R** perform the analysis on the significant cell-cell communication singals to find if a ligand-receiptor (LR) pair enriched in a sample of condition in interest, the input is a LR pair dataframe (csv file) output from **2nd_run_commot_cluster.py**, containing information of significant LR pairs, cell types that communicate with each other through the LR, and the corresponding p-values. 
